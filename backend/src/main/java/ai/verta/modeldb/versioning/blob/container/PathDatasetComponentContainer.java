package ai.verta.modeldb.versioning.blob.container;

import ai.verta.modeldb.ModelDBException;
import ai.verta.modeldb.versioning.autogenerated._public.modeldb.versioning.model.AutogenGitCodeBlob;
import ai.verta.modeldb.versioning.autogenerated._public.modeldb.versioning.model.AutogenPathDatasetComponentBlob;
import io.grpc.Status.Code;

public class PathDatasetComponentContainer implements BlobContainerBase {

  private final AutogenPathDatasetComponentBlob autogenPathDatasetComponentBlob;

  public PathDatasetComponentContainer(
      AutogenPathDatasetComponentBlob autogenPathDatasetComponentBlob) {
    this.autogenPathDatasetComponentBlob = autogenPathDatasetComponentBlob;
  }

  @Override
  public void validate() throws ModelDBException {
    if (autogenPathDatasetComponentBlob.getPath().isEmpty()) {
      throw new ModelDBException("Dataset path is empty", Code.INVALID_ARGUMENT);
    }
  }

}
