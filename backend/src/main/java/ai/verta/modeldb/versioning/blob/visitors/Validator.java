package ai.verta.modeldb.versioning.blob.visitors;

import ai.verta.modeldb.ModelDBException;
import ai.verta.modeldb.versioning.autogenerated._public.modeldb.versioning.model.AutogenPathDatasetBlob;
import ai.verta.modeldb.versioning.autogenerated._public.modeldb.versioning.model.AutogenS3DatasetBlob;
import io.grpc.Status;

public class Validator extends Visitor {
  @Override
  public void preVisitAutogenPathDatasetBlob(AutogenPathDatasetBlob blob) throws ModelDBException {
    if (blob.getComponents().isEmpty())
      throw new ModelDBException("Blob should not be empty", Status.Code.INVALID_ARGUMENT);
  }

  @Override
  public void preVisitAutogenS3DatasetBlob(AutogenS3DatasetBlob blob) throws ModelDBException {
    if (blob.getComponents().isEmpty())
      throw new ModelDBException("Blob should not be empty", Status.Code.INVALID_ARGUMENT);
  }
}
