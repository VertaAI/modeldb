package ai.verta.modeldb.versioning.blob.diff;

import ai.verta.modeldb.versioning.autogenerated._public.modeldb.versioning.model.Blob;

public class TypeChecker {
  public static String getType(Blob b) {
    if (b == null) {
      return null;
    } else {
      if (b.Dataset != null) {
        if (b.Dataset.Path != null) {
          return "DatasetPath";
        }
        if (b.Dataset.S3 != null) {
          return "DatasetS3";
        }
        return "DatasetUnknown";
      }
      if (b.Config != null) {
        return "Config";
      }
      if (b.Environment != null) {
        if (b.Environment.Docker != null) {
          return "EnvironmentDocker";
        }
        if (b.Environment.Python != null) {
          return "EnvironmentPython";
        }
        return "EnvironmentUnknown";
      }
      if (b.Code != null) {
        if (b.Code.Git != null) {
          return "CodeGit";
        }
        if (b.Code.Notebook != null) {
          return "CodeNotebook";
        }
        return "CodeUnknown";
      }
      return "Unknown";
    }
  }

  public static Boolean sameType(Blob a, Blob b) {
    return getType(a).equals(getType(b));
  }
}
